setwd("/media/Datos/Biología/github/AFLPsim")
ls
ls()
source('~/.active-rstudio-document')
hybridsim(10,100,100,30)
source('~/.active-rstudio-document')
hybridsim(10,100,100,30)
hybridsim(10,100,100,30,hybrid="Bx")
source('~/.active-rstudio-document')
hybridsim(10,100,100,30,hybrid="Bx")
source('~/.active-rstudio-document')
hybridsim(10,100,100,30,hybrid="Bx")
source('~/.active-rstudio-document')
hybridsim(10,100,100,30,hybrid="Bx")
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/format/introgressformat.R')
hybridsim(100,100,100,30,hybrid="Bx")
simulation
source('~/.active-rstudio-document')
hybridsim(100,100,100,30,hybrid="BxA")
source('~/.active-rstudio-document')
hybridsim(100,100,100,30,hybrid="BxA")
tst<-hybridsim(100,100,100,30,hybrid="BxA")
tsti<-introgressformat(tst)
tsti
library(introgress)
introdata<-prepare.data(admix.gen=tstit$admix.gen, loci.data=tstit$loci,parental1=tstit$parental1, parental2=tstit$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=tstit$loci, fixed=FALSE)
introdata<-prepare.data(admix.gen=tsti$admix.gen, loci.data=tsti$loci,parental1=tsti$parental1, parental2=tsti$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=tsti$loci, fixed=FALSE)
ls()
tsti
introdata<-prepare.data(admix.gen=tsti[[1]]$admix.gen, loci.data=tsti[[1]]$loci,parental1=tsti[[1]]$parental1, parental2=tsti[[1]]$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=tsti[[1]]$loci, fixed=FALSE)
indexh
indexh[,3]
indexh[,2]
hist(indexh[,2])
tst<-hybridsim(300,100,100,30,hybrid="BxA")
tsti<-introgressformat(tst)
introdata<-prepare.data(admix.gen=tsti[[1]]$admix.gen, loci.data=tsti[[1]]$loci,parental1=tsti[[1]]$parental1, parental2=tsti[[1]]$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=tsti[[1]]$loci, fixed=FALSE)
hist(indexh[,2])
summary(indexh)
tstb<-hybridsim(300,100,100,30,hybrid="BxB")
source('~/.active-rstudio-document')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
tstb<-hybridsim(300,100,100,30,hybrid="BxB")
tsti<-introgressformat(tstb)
introdata<-prepare.data(admix.gen=tsti[[1]]$admix.gen, loci.data=tsti[[1]]$loci,parental1=tsti[[1]]$parental1, parental2=tsti[[1]]$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=tsti[[1]]$loci, fixed=FALSE)
hist(indexh[,2])
summary(indexh)
summary(indexh[,2])
var(indexh[,2])
std.error(indexh[,2])
library(plotrix)
std.error(indexh[,2])
mean(indexh[,2])
library(boot)
?boot
boot.ci
source('~/.active-rstudio-document')
tst<-hybridsim(30,100,100,30,hybrid="all")
tst
source('~/.active-rstudio-document')
tst<-hybridsim(30,10,10,30,hybrid="all")
hybridsim(30,10,10,30,hybrid="all")
source('~/.active-rstudio-document')
hybridsim(30,10,10,30,hybrid="all")
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
hybridsim(30,10,10,30,hybrid="all")
source('~/.active-rstudio-document')
hybridsim(30,10,10,30,hybrid="all")
hybridsim(30,10,10,30,hybrid="F1")
source('~/.active-rstudio-document')
hybridsim(30,10,10,30,hybrid="F1")
hybridsim(30,10,10,30,hybrid="all")
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
hybridsim(100,10,10,30,hybrid="all")
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
hybridsim(100,10,10,30,hybrid="all")
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
hybridsim(100,10,10,30,hybrid="all")
hybridsim(100,10,10,30,hybrid="all",S=10)
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('~/.active-rstudio-document')
hybridsim(100,10,10,30,hybrid="all",S=10)
hybridsim(100,10,10,30,hybrid="F1",S=10)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
hybridsim(100,10,10,30,hybrid="F1",S=10)
hybridsim(10,10,10,10,hybrid="F1",S=10)
hybridsim(10,10,10,10,hybrid="all",S=10)
hybridsim(10,10,10,10,hybrid="BxA",S=10)
source('~/.active-rstudio-document')
hybridsim(10,10,10,10,hybrid="BxA",S=10)
source('~/.active-rstudio-document')
hybridsim(10,10,10,10,hybrid="BxA",S=10)
source('~/.active-rstudio-document')
t<-hybridsim(10,10,10,10,hybrid="BxA",S=10)
t
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
t
class(t)
t(t)
t(t[[1]])
rbind(t(t[[1]]), t(t[[2]]))
cbind(t(t[[1]]), t(t[[2]]))
cbind(t(t[[1:2]])
)
t[[1:2]]
t[[1]]
t[[3]]
cbind(t(t[[1]]), t(t[[3]]))
is.na(t[[1]])
is.na(t[[3]])
is.na(t[[4]])
is.na(t[[3]])
t[[3]]
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
t<-hybridsim(10,10,10,10,hybrid="BxA",S=10)
is.na(t[[3]])
cbind(t(t[[1]]), t(t[[3]]))
t(t[[3]])
install.packages(qpcR)
install.packages("qpcR")
library(qpcR)
cbind.na
cbind.na()
help(qpcR)
?qpcR
?cbind
t(t[[3]])
t(t[[3]]) == "NA"
t[[3]] == "NA"
t[t[[3]] == "NA"]
t
source('~/.active-rstudio-document')
t
introgressformat(t)
source('~/.active-rstudio-document')
introgressformat(t)
source('~/.active-rstudio-document')
introgressformat(t)
dim(t(t[[1]]))
r<-matrix()
dim(r)
dim(r)<-c(2,2)
dim(r)<-2
length(t(t[[1]]))
t
class(t(t[[1]]))
nrow(t(t[[1]]))
source('~/.active-rstudio-document')
introgressformat(t)
is.na(t[[4]])
t<-hybridsim(20,10,10,10,hybrid="all",S=10)
introgressformat(t)
source('~/.active-rstudio-document')
introgressformat(t)
source('~/.active-rstudio-document')
introgressformat(t)
a<-introgressformat(t)
a
source('~/.active-rstudio-document')
a<-introgressformat(t)
a
source('~/.active-rstudio-document')
a<-introgressformat(t)
a
introdata<-prepare.data(admix.gen=a$admix.gen, loci.data=a$loci,parental1=a$parental1, parental2=a$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=a$loci, fixed=FALSE)
a
indexh
hist(indexh)
hist(indexh[,2])
a<-hybridsim(100,30,30,30,hybrid="all",S=0)
a
a<-introgressformat(a)
a
introdata<-prepare.data(admix.gen=a$admix.gen, loci.data=a$loci,parental1=a$parental1, parental2=a$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=a$loci, fixed=FALSE)
hist(indexh[,2])
summary(indexh[,2])
a<-hybridsim(300,100,100,50,hybrid="all",S=0)
a<-introgressformat(a)
introdata<-prepare.data(admix.gen=a$admix.gen, loci.data=a$loci,parental1=a$parental1, parental2=a$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=a$loci, fixed=FALSE)
summary(indexh[,2])
hist(indexh[,2])
a
a<-hybridsim(300,100,100,50,hybrid=c("BxA","BxB"),S=0)
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
a<-hybridsim(500,100,100,50,hybrid=all,S=0)
a<-hybridsim(500,100,100,50,hybrid= "all",S=0)
a<-introgressformat(a)
introdata<-prepare.data(admix.gen=a$admix.gen, loci.data=a$loci,parental1=a$parental1, parental2=a$parental2,pop.id=F, ind.id=F)
indexh<-est.h(introgress.data=introdata, loci.data=a$loci, fixed=FALSE)
hist(indexh[,2])
hist(indexh[,2],col=2)
hist(indexh[,2],col=2,ylab="hybrid index")
hist(indexh[,2],col=2,xlab="hybrid index")
hist(indexh[,2],col=1,xlab="hybrid index")
hist(indexh[,2],col="grey",xlab="hybrid index")
hist(indexh[,2],col="grey",xlab="hybrid index", main="")
hist(indexh[,2],col="grey",xlab="hybrid index", main="", xlim=c(0,1))
source('~/.active-rstudio-document')
a
a<-hybridsim(500,100,100,50,hybrid= "all",S=0)
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
n<-nrow(a[[3]])
n
admix.gen <-matrix(nrow=n)
admix.gen<-rbind(admix.gen,a[[3]])
admix.gen<-cbind(admix.gen,a[[3]])
admix.gen
head(admix.gen)
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
n<-nrow(matriz[[3]])
admix.gen <-matrix(nrow=n)
if (is.na(matriz[[3]]) == F){admix.gen<-cbind(admix.gen,matriz[[3]])}
if (is.na(matriz[[4]]) == F){admix.gen<-cbind(admix.gen,matriz[[4]])}
if (is.na(matriz[[5]]) == F){admix.gen<-cbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
admi.gen}
sim2Newhybrids(a,"testnewhybrids.txt")
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
n<-nrow(matriz[[3]])
admix.gen <-matrix(nrow=n)
if (is.na(matriz[[3]]) == F){admix.gen<-cbind(admix.gen,matriz[[3]])}
if (is.na(matriz[[4]]) == F){admix.gen<-cbind(admix.gen,matriz[[4]])}
if (is.na(matriz[[5]]) == F){admix.gen<-cbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
admix.gen}
sim2Newhybrids(a,"testnewhybrids.txt")
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
n<-nrow(matriz[[3]])
admix.gen <-matrix(nrow=n)
if (is.na(matriz[[3]]) == F){admix.gen<-rbind(admix.gen,matriz[[3]])}
if (is.na(matriz[[4]]) == F){admix.gen<-rbind(admix.gen,matriz[[4]])}
if (is.na(matriz[[5]]) == F){admix.gen<-rbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
admix.gen}
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
getwd()
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
nr<-nrow(matriz[[3]])
nc<-ncol(matriz[[3]])
admix.gen <-matrix(ncol=nc)
if (is.na(matriz[[3]]) == F){admix.gen<-rbind(admix.gen,matriz[[3]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[4]]) == F){admix.gen<-rbind(admix.gen,matriz[[4]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[5]]) == F){admix.gen<-rbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
admix.gen}
sim2Newhybrids(a,"testnewhybrids.txt")
e<-sim2Newhybrids(a,"testnewhybrids.txt")
tail(e)
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
nr<-nrow(matriz[[3]])
nc<-ncol(matriz[[3]])
admix.gen <-matrix(ncol=nc)
if (is.na(matriz[[3]]) == F){admix.gen<-rbind(admix.gen,matriz[[3]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[4]]) == F){admix.gen<-rbind(admix.gen,matriz[[4]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[5]]) == F){admix.gen<-rbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
admix.gen
raw<-rbind(matriz$PA,matriz$PB,admix.gen)
raw}
tail(e)
head(e)
e<-sim2Newhybrids(a,"testnewhybrids.txt")
head(e)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
nr<-nrow(matriz[[3]])
nc<-ncol(matriz[[3]])
admix.gen <-matrix(ncol=nc)
if (is.na(matriz[[3]]) == F){admix.gen<-rbind(admix.gen,matriz[[3]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[4]]) == F){admix.gen<-rbind(admix.gen,matriz[[4]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[5]]) == F){admix.gen<-rbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
raw<-rbind(matriz$PA,matriz$PB,admix.gen)
ind<-rownames(raw)
ind}
sim2Newhybrids(a)
a
sim2Newhybrids<- function (matriz,filename) {
matriz$PA[matriz$PA==0]<-"-"
matriz$PA[matriz$PA==1]<-"+"
matriz$PB[matriz$PB==0]<-"-"
matriz$PB[matriz$PB==1]<-"+"
matriz[[3]][matriz[[3]]==0]<-"-"
matriz[[3]][matriz[[3]]==1]<-"+"
matriz[[4]][matriz[[4]]==0]<-"-"
matriz[[4]][matriz[[4]]==1]<-"+"
matriz[[5]][matriz[[5]]==0]<-"-"
matriz[[5]][matriz[[5]]==1]<-"+"
nr<-nrow(matriz[[3]])
nc<-ncol(matriz[[3]])
admix.gen <-matrix(ncol=nc)
if (is.na(matriz[[3]]) == F){admix.gen<-rbind(admix.gen,matriz[[3]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[4]]) == F){admix.gen<-rbind(admix.gen,matriz[[4]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
if (is.na(matriz[[5]]) == F){admix.gen<-rbind(admix.gen,matriz[[5]])}
admix.gen<-admix.gen[,which(colMeans(is.na(admix.gen)) < 1)]
raw<-rbind(matriz$PA,matriz$PB,admix.gen)
raw}
sim2Newhybrids(a)
e<-sim2Newhybrids(a)
e[201,]
source('~/.active-rstudio-document')
sim2Newhybrids(a)
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"testnewhybrids.txt")
a
source('~/.active-rstudio-document')
a<-hybridsim(300,100,100,50,hybrid="all")
a
source('~/.active-rstudio-document')
sim2Newhybrids(a,"test.txt")
source('~/.active-rstudio-document')
sim2Newhybrids(a,"test.txt")
getwd()
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/format/sim2newhybrids2.R')
sim2Newhybrids(a,"test.txt")
git status
summary
?summary
library(adegenet)
?adegenet
?genind
showClass("genind")
validObject
?validObject
?validObject(genind)
validObject(genind)
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
datos<-hybridsim(100,30,30,30, type="neutral")
datos
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/format/introgressformat.R')
datosint<-introgressformat(datos)
datosint
source('~/.active-rstudio-document')
Arlequin(datos,"arlequidatos.arp")
source('~/.active-rstudio-document')
Arlequin(datos,"arlequidatos.arp")
getwd()
datos2<-hybridsim(100,30,30,30, type="neutral", hybrid=c("F1","BxB"))
datos2
Arlequin(datos2,"arlequidatos2.arp")
hybrids<-AFLPsim(Nmarker=100, Na=30, Nb=30, Nf1=30, type="selection", Nsel=25, hybrid="F1")
hybrids<-aflpsim(Nmarker=100, Na=30, Nb=30, Nf1=30, type="selection", Nsel=25, hybrid="F1")
hybrids<-hybridsim(Nmarker=100, Na=30, Nb=30, Nf1=30, type="selection", Nsel=25, hybrid="F1")
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
hybrids<-hybridsim(Nmarker=100, Na=30, Nb=30, Nf1=30, type="selection", Nsel=25, hybrid="F1")
hybrid
hybrids
source('~/.active-rstudio-document')
hybridsim(10,10,10,10,hybrid="F1")
hybridsim(10,10,10,10,hybrid="F1", S=10)
source('/media/Datos/Biología/github/AFLPsim/funcionesfinales/simulations/hybridsim2.R')
